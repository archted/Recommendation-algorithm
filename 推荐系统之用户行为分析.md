# 推荐系统之用户行为分析

## 用户行为介绍

基于用户行为的推荐，在学术界名为协同过滤算法。
**协同过滤就是指用户可以齐心协力，通过不断地和网站互动，使 自己的推荐列表能够不断过滤掉自己不感兴趣的物品，从而越来越满足自己的需求。**

用户行为在个性化推荐系统中一般分两种——显性反馈行为（explicit feedback）和隐性反馈 行为（implicit feedback）。

- 显性反馈行为包括用户明确表示对物品喜好的行为：主要方式就是评分和喜欢/不喜欢；
- 隐性反馈行为指的是那些不能明确反应用户喜好的行为：最具代表性的隐性反馈行为就是页面浏览行为；

反馈除了分为显性和隐性外，还能分为正反馈、负反馈

## 用户行为分析

先定义两个变量：
用户活跃度：用户产生过行为的物品总数
物品流行度：对物品产生过行为的用户总数
而用户活跃度和物品流行度的人数都符合Power Law，也称为长尾分布：![img](http://static.zybuluo.com/zhuanxu/hnn9c6qzvc8vqaikc62atubg/image_1c17pv0eaq6vkdcf62fek16ee1g.png)。

用户活跃度和物品流行度的关系是：用户越活跃，越倾向于浏览冷门的物品。

仅仅基于用户行为数据设计的推荐算法一般称为协同过滤算法。

## 基于邻域的算法

基于领域的方法中，主要包括两大类：

- 基于用户的协同过滤算法，背后的思想是根据用户的历史行为，**对用户进行聚类**，然后**基于同一类用户的共同喜好**，给用户推荐物品。
- 基于物品的协同过滤算法，这种算法**对商品进行聚类**，给用户推荐和他之前喜欢的物品相似的物品。

### 基于用户的协同过滤算法

基于用户的协同过滤算法主要包括两个步骤：
(1) 找到和目标用户兴趣相似的用户集合。
(2) 找到这个集合中的用户喜欢的，且目标用户没有听说过的物品推荐给目标用户。

### 基于物品的协同过滤算法

基于item的协同过滤，通过用户对不同item的评分来评测 item 之间的相似性，基于item 之间的相似性做出推荐，简单来讲就是：给用户推荐和他之前喜欢的物品相似的物品。

### UserCF和ItemCF的综合比较

![img](http://static.zybuluo.com/zhuanxu/32qmryy23gvqrrlddayn5uby/image_1c17ravd7b1f1pt4r4upgbfoa2n.png)

对于电子商务，用户数量一般大大超过商品数量，此时Item CF的计算复杂度较低。

在社交网络站点中，User CF 是一个更不错的选择，User CF 加上社会网络信息，可以增加用户对推荐解释的信服程度。

## 基于模型的算法

### 隐语义模型（LFM）

隐语义模型最早在文本挖掘领域被提出，用于找到文本的隐含语义。

LFM源于对SVD（奇异值分解）方法的改进，传统SVD是线性代数典型问题，但由于计算量太大，实际上只是适用于规模很小的系统，Simon Funk改进了SVD（Funk-SVD），后来被称为Latent Factor Model。

LFM假设了一个隐含的变量，用户兴趣，看下面的矩阵分解：
![img](http://static.zybuluo.com/zhuanxu/wa785gvio6bqgqyuvgfckcm8/image_1c183empa1bq1iq72jg16jq1dp34.png)
R 矩阵是 user-item 矩阵，矩阵值 Rij 表示的是 user i 对 item j 的兴趣度，对于其中缺失的值，我们可以先给一个平均值。 LFM 算法从数据集中抽取出若隐变量，作为 user 和 item 之间连接的桥梁，将 R 矩阵表示为 P 矩阵和 Q 矩阵相乘。其中 P 矩阵是 user-topic 矩阵，矩阵值 **Pij 表示的是 user i 对 topic j 的兴趣度**；Q 矩阵式 topic-item 矩阵，矩阵值 **Qij 表示的是 item j 在 topic i 中的权重。**

上面这个过程就是一个svd的过程，但是当矩阵太大的时候，svd分解会太慢，于是就有了下面的方法：
![img](http://static.zybuluo.com/zhuanxu/pnoaewt9ckfopg8ati23tqw0/image_1c183kc7tmi411po1iaim6t1l2o3h.png)
将矩阵分解转换为一个机器学习问题，我们通过梯度下降的方法去预估Rij，先求导：
![img](http://static.zybuluo.com/zhuanxu/pw033fvaxfmy63k6ex7mo3vs/image_1c183shha70o1ifl4re196j1k3f3u.png)
后更新：
![img](http://static.zybuluo.com/zhuanxu/kwk0qdat9yqyq1n0rep4yci9/image_1c183t3f01n19ceg10vh1qtf12fb4b.png)
上面的算法的超参数有：

- 隐特征的个数F；
- 学习速率alpha；
- 正则化参数lambda；

还有一个没讲到的是，对于Rij，我们现在只有正样本，即user-item中有的我们算Rij=1，我们要去获取负样本，Rij=0的值，负样在选择上秉持的原则是：

- 对每个用户，要保证正负样本的平衡（数目相似）。
- 对每个用户采样负样本时，要选取那些很热门，而用户却没有行为的物品。

此处选择采用热门商品的原因是：对于冷门的物 品，用户可能是压根没在网站中发现这个物品，所以谈不上是否感兴趣。

### 贝叶斯网络（待补充）

### SVM（待补充）

## 总结

本文首先介绍了用户行为的基本概念，介绍了显性反馈行为和隐性反馈行为，以及正反馈和负反馈，接着介绍了两大类推荐算法：基于领域的算法和隐语义模型，下面一篇会通过[Surprise](http://surpriselib.com/)库来用今天介绍的算法来解决一些实际问题。